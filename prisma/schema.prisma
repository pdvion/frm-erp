// POC Delphi FRM - Schema do Banco de Dados
// Migração do sistema ERP industrial FRM (Delphi) para stack moderna

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
}

// =============================================================================
// ENUMS
// =============================================================================

enum MaterialStatus {
  ACTIVE
  INACTIVE
  BLOCKED
}

enum SupplierStatus {
  ACTIVE
  INACTIVE
  BLOCKED
}

enum MovementType {
  ENTRY        // Entrada
  EXIT         // Saída
  TRANSFER     // Transferência
  ADJUSTMENT   // Ajuste de inventário
  RETURN       // Devolução
  PRODUCTION   // Produção
}

enum InventoryType {
  RAW_MATERIAL    // Matéria-Prima
  SEMI_FINISHED   // Semi-Acabado
  FINISHED        // Pronto
  CRITICAL        // Crítico
  DEAD            // Morto
  SCRAP           // Refugo
}

enum QuoteStatus {
  DRAFT           // Rascunho
  PENDING         // Pendente
  SENT            // Enviado
  RECEIVED        // Recebido
  APPROVED        // Aprovado
  REJECTED        // Rejeitado
  CANCELLED       // Cancelado
}

enum PayableStatus {
  PENDING         // Pendente
  PARTIAL         // Parcialmente pago
  PAID            // Pago
  OVERDUE         // Vencido
  CANCELLED       // Cancelado
}

enum PayableType {
  INVOICE         // Nota Fiscal
  SERVICE         // Serviço
  TAX             // Imposto
  OTHER           // Outros
}

// =============================================================================
// TABELAS BASE (A00)
// =============================================================================

model Company {
  id          String   @id @default(uuid())
  code        Int      @unique // codEmpresa original
  name        String   // nomeEmpresa
  tradeName   String?  // nomeFantasia
  cnpj        String?  @unique
  ie          String?  // Inscrição Estadual
  address     String?
  city        String?
  state       String?
  zipCode     String?
  phone       String?
  email       String?
  isActive    Boolean  @default(true)
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  materials    Material[]
  suppliers    Supplier[]
  inventory    Inventory[]
  users        User[]
  categories   Category[]
  userCompanies UserCompany[]
  permissions  UserCompanyPermission[]
  cloneLogsSource CloneLog[] @relation("CloneSource")
  cloneLogsTarget CloneLog[] @relation("CloneTarget")
  purchaseOrders  PurchaseOrder[]
  receivedInvoices ReceivedInvoice[]
  userGroups   UserGroup[]
  systemSettings SystemSetting[]
  accountsPayable AccountsPayable[]

  @@map("companies")
}

model User {
  id          String   @id @default(uuid())
  code        Int?     // codUsuario original
  email       String   @unique
  name        String
  password    String?
  isActive    Boolean  @default(true)
  companyId   String?  // Empresa padrão (legado)
  company     Company? @relation(fields: [companyId], references: [id])
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  inventoryMovements InventoryMovement[]
  userCompanies      UserCompany[]
  permissions        UserCompanyPermission[]
  cloneLogs          CloneLog[]
  auditLogs          AuditLog[]
  groupMemberships   UserGroupMember[]
  addedToGroups      UserGroupMember[] @relation("AddedByUser")
  settingsUpdated    SystemSetting[]

  @@map("users")
}

// =============================================================================
// MULTI-TENANT: Permissões por Empresa
// =============================================================================

enum PermissionLevel {
  NONE
  VIEW
  EDIT
  FULL
}

enum SystemModule {
  MATERIALS
  SUPPLIERS
  QUOTES
  RECEIVING
  MATERIAL_OUT
  INVENTORY
  REPORTS
  SETTINGS
}

// Acesso do usuário às empresas do grupo
model UserCompany {
  id          String   @id @default(uuid())
  userId      String
  user        User     @relation(fields: [userId], references: [id], onDelete: Cascade)
  companyId   String
  company     Company  @relation(fields: [companyId], references: [id], onDelete: Cascade)
  isDefault   Boolean  @default(false)
  isActive    Boolean  @default(true)
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  @@unique([userId, companyId])
  @@map("user_companies")
}

// Permissões granulares: Usuário x Empresa x Módulo
model UserCompanyPermission {
  id          String          @id @default(uuid())
  userId      String
  user        User            @relation(fields: [userId], references: [id], onDelete: Cascade)
  companyId   String
  company     Company         @relation(fields: [companyId], references: [id], onDelete: Cascade)
  module      SystemModule
  permission  PermissionLevel @default(NONE)
  canShare    Boolean         @default(false)
  canClone    Boolean         @default(false)
  createdAt   DateTime        @default(now())
  updatedAt   DateTime        @updatedAt

  @@unique([userId, companyId, module])
  @@map("user_company_permissions")
}

// =============================================================================
// CONFIGURAÇÕES DO SISTEMA
// =============================================================================

model SystemSetting {
  id          String   @id @default(uuid()) @db.Uuid
  key         String   @db.VarChar(100)
  value       Json
  category    String   @default("general") @db.VarChar(50)
  companyId   String?  @db.Uuid
  company     Company? @relation(fields: [companyId], references: [id], onDelete: Cascade)
  description String?
  updatedBy   String?  @db.Uuid
  updatedByUser User?  @relation(fields: [updatedBy], references: [id], onDelete: SetNull)
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  @@unique([key, companyId])
  @@index([category])
  @@map("system_settings")
}

// =============================================================================
// SISTEMA DE GRUPOS E PERMISSÕES
// =============================================================================

// Grupos de usuários com permissões
model UserGroup {
  id          String   @id @default(uuid()) @db.Uuid
  name        String   @db.VarChar(100)
  description String?
  companyId   String?  @db.Uuid
  company     Company? @relation(fields: [companyId], references: [id], onDelete: Cascade)
  permissions Json     @default("[]") // Array de permissões: ["materials.*", "settings.landing.edit"]
  isSystem    Boolean  @default(false) // Grupos do sistema não podem ser deletados
  isActive    Boolean  @default(true)
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  members     UserGroupMember[]

  @@unique([name, companyId])
  @@map("user_groups")
}

// Membros dos grupos
model UserGroupMember {
  id        String    @id @default(uuid()) @db.Uuid
  userId    String    @db.Uuid
  user      User      @relation(fields: [userId], references: [id], onDelete: Cascade)
  groupId   String    @db.Uuid
  group     UserGroup @relation(fields: [groupId], references: [id], onDelete: Cascade)
  addedBy   String?   @db.Uuid
  addedByUser User?   @relation("AddedByUser", fields: [addedBy], references: [id], onDelete: SetNull)
  addedAt   DateTime  @default(now())

  @@unique([userId, groupId])
  @@map("user_group_members")
}

// Log de clonagem de configurações entre empresas
model CloneLog {
  id              String   @id @default(uuid())
  sourceCompanyId String
  sourceCompany   Company  @relation("CloneSource", fields: [sourceCompanyId], references: [id])
  targetCompanyId String
  targetCompany   Company  @relation("CloneTarget", fields: [targetCompanyId], references: [id])
  entityType      String
  entityId        String
  clonedEntityId  String
  clonedBy        String
  clonedByUser    User     @relation(fields: [clonedBy], references: [id])
  createdAt       DateTime @default(now())

  @@map("clone_logs")
}

// =============================================================================
// MÓDULO CP06 - CATEGORIAS/FAMÍLIAS
// =============================================================================

model Category {
  id          String     @id @default(uuid())
  code        Int?       // codFamilia original
  name        String     // descFamilia
  parentId    String?    // id_pai para subcategorias
  parent      Category?  @relation("CategoryHierarchy", fields: [parentId], references: [id])
  children    Category[] @relation("CategoryHierarchy")
  companyId   String?    // Empresa dona (null = global)
  company     Company?   @relation(fields: [companyId], references: [id])
  isShared    Boolean    @default(false) // Visível para outras empresas?
  isActive    Boolean    @default(true)
  createdAt   DateTime   @default(now())
  updatedAt   DateTime   @updatedAt

  materials   Material[]

  @@map("categories")
}

// =============================================================================
// MÓDULO CP10 - MATERIAIS
// =============================================================================

model Material {
  id                  String         @id @default(uuid())
  code                Int            @unique // codMaterial original
  internalCode        String?        // codigo interno (material_codCA)
  description         String         // descMaterial
  categoryId          String?
  category            Category?      @relation(fields: [categoryId], references: [id])
  unit                String         @default("UN") // unidadeEstoque
  location            String?        // local de armazenamento
  minQuantity         Float          @default(0) // qdeMinima
  maxQuantity         Float?         // qdeMaxima
  monthlyAverage      Float          @default(0) // qdeMediaMensal
  lastPurchasePrice   Float?         // vlrUnitUltCompra
  lastPurchaseDate    DateTime?      // dtUltCompra
  ncm                 String?        // código NCM
  status              MaterialStatus @default(ACTIVE)
  requiresQualityCheck Boolean       @default(false) // requerIQF
  isShared            Boolean        @default(false) // Visível para outras empresas?
  companyId           String?
  company             Company?       @relation(fields: [companyId], references: [id])
  createdAt           DateTime       @default(now())
  updatedAt           DateTime       @updatedAt

  inventory           Inventory[]
  supplierMaterials   SupplierMaterial[]
  quoteItems          QuoteItem[]
  purchaseOrderItems  PurchaseOrderItem[]
  receivedInvoiceItems ReceivedInvoiceItem[]

  @@map("materials")
}

// =============================================================================
// MÓDULO CP11 - FORNECEDORES
// =============================================================================

model Supplier {
  id              String         @id @default(uuid())
  code            Int            @unique // codFornecedor original
  companyName     String         // razaoSocial
  tradeName       String?        // nomeFantasia
  cnpj            String?        @unique
  cpf             String?        // para PF
  ie              String?        // Inscrição Estadual
  im              String?        // Inscrição Municipal
  address         String?
  number          String?
  complement      String?
  neighborhood    String?
  city            String?
  state           String?
  zipCode         String?
  country         String         @default("Brasil")
  phone           String?
  mobile          String?
  email           String?
  website         String?
  contactName     String?        // contato principal
  paymentTerms    String?        // condições de pagamento
  notes           String?
  status          SupplierStatus @default(ACTIVE)
  qualityIndex    Float?         // IQF - Índice de Qualidade
  isShared        Boolean        @default(false) // Visível para outras empresas?
  companyId       String?
  company         Company?       @relation(fields: [companyId], references: [id])
  createdAt       DateTime       @default(now())
  updatedAt       DateTime       @updatedAt

  supplierMaterials SupplierMaterial[]
  quotes            Quote[]
  inventoryMovements InventoryMovement[]
  purchaseOrders    PurchaseOrder[]
  receivedInvoices  ReceivedInvoice[]
  accountsPayable   AccountsPayable[]

  @@map("suppliers")
}

// Relação N:N entre Fornecedores e Materiais
model SupplierMaterial {
  id              String    @id @default(uuid())
  supplierId      String
  supplier        Supplier  @relation(fields: [supplierId], references: [id], onDelete: Cascade)
  materialId      String
  material        Material  @relation(fields: [materialId], references: [id], onDelete: Cascade)
  supplierCode    String?   // código do material no fornecedor
  lastPrice       Float?
  lastPriceDate   DateTime?
  leadTimeDays    Int?      // prazo de entrega em dias
  minOrderQty     Float?    // quantidade mínima de pedido
  isPreferred     Boolean   @default(false)
  createdAt       DateTime  @default(now())
  updatedAt       DateTime  @updatedAt

  @@unique([supplierId, materialId])
  @@map("supplier_materials")
}

// =============================================================================
// MÓDULO EST10 - ESTOQUE
// =============================================================================

model Inventory {
  id              String        @id @default(uuid())
  materialId      String
  material        Material      @relation(fields: [materialId], references: [id])
  companyId       String?
  company         Company?      @relation(fields: [companyId], references: [id])
  inventoryType   InventoryType @default(RAW_MATERIAL)
  quantity        Float         @default(0)
  reservedQty     Float         @default(0) // quantidade reservada
  availableQty    Float         @default(0) // quantidade disponível
  unitCost        Float         @default(0) // custo unitário médio
  totalCost       Float         @default(0) // custo total
  lastMovementAt  DateTime?
  createdAt       DateTime      @default(now())
  updatedAt       DateTime      @updatedAt

  movements       InventoryMovement[]

  @@unique([materialId, companyId, inventoryType])
  @@map("inventory")
}

model InventoryMovement {
  id              String       @id @default(uuid())
  inventoryId     String
  inventory       Inventory    @relation(fields: [inventoryId], references: [id])
  movementType    MovementType
  quantity        Float
  unitCost        Float        @default(0)
  totalCost       Float        @default(0)
  balanceAfter    Float        @default(0) // saldo após movimento
  documentType    String?      // tipo de documento (NF, OS, etc)
  documentNumber  String?      // número do documento
  documentId      String?      // referência ao documento
  supplierId      String?      // fornecedor (para entradas)
  supplier        Supplier?    @relation(fields: [supplierId], references: [id])
  notes           String?
  userId          String?
  user            User?        @relation(fields: [userId], references: [id])
  movementDate    DateTime     @default(now())
  createdAt       DateTime     @default(now())

  @@index([inventoryId, movementDate])
  @@map("inventory_movements")
}

// =============================================================================
// MÓDULO CP12 - ORÇAMENTOS/COTAÇÕES
// =============================================================================

model Quote {
  id              String      @id @default(uuid())
  code            Int         @unique // número do orçamento
  supplierId      String
  supplier        Supplier    @relation(fields: [supplierId], references: [id])
  status          QuoteStatus @default(DRAFT)
  requestDate     DateTime    @default(now())
  responseDate    DateTime?
  validUntil      DateTime?
  paymentTerms    String?
  deliveryTerms   String?
  freightValue    Float       @default(0)
  discountPercent Float       @default(0)
  totalValue      Float       @default(0)
  notes           String?
  createdAt       DateTime    @default(now())
  updatedAt       DateTime    @updatedAt

  items           QuoteItem[]
  purchaseOrders  PurchaseOrder[]

  @@map("quotes")
}

model QuoteItem {
  id              String   @id @default(uuid())
  quoteId         String
  quote           Quote    @relation(fields: [quoteId], references: [id], onDelete: Cascade)
  materialId      String
  material        Material @relation(fields: [materialId], references: [id])
  quantity        Float
  unitPrice       Float    @default(0)
  totalPrice      Float    @default(0)
  deliveryDays    Int?     // prazo de entrega
  notes           String?
  createdAt       DateTime @default(now())
  updatedAt       DateTime @updatedAt

  purchaseOrderItems PurchaseOrderItem[]

  @@map("quote_items")
}

// =============================================================================
// MÓDULO PEDIDO DE COMPRA
// =============================================================================

enum PurchaseOrderStatus {
  DRAFT
  PENDING
  APPROVED
  SENT
  PARTIAL
  COMPLETED
  CANCELLED
}

model PurchaseOrder {
  id                    String              @id @default(uuid())
  code                  Int                 @unique
  supplierId            String
  supplier              Supplier            @relation(fields: [supplierId], references: [id])
  quoteId               String?
  quote                 Quote?              @relation(fields: [quoteId], references: [id])
  status                PurchaseOrderStatus @default(DRAFT)
  orderDate             DateTime            @default(now())
  expectedDeliveryDate  DateTime?
  actualDeliveryDate    DateTime?
  paymentTerms          String?
  deliveryTerms         String?
  freightValue          Float               @default(0)
  discountPercent       Float               @default(0)
  totalValue            Float               @default(0)
  notes                 String?
  companyId             String?
  company               Company?            @relation(fields: [companyId], references: [id])
  createdAt             DateTime            @default(now())
  updatedAt             DateTime            @updatedAt

  items                 PurchaseOrderItem[]
  receivedInvoices      ReceivedInvoice[]

  @@index([supplierId])
  @@index([companyId])
  @@index([status])
  @@map("purchase_orders")
}

model PurchaseOrderItem {
  id              String        @id @default(uuid())
  purchaseOrderId String
  purchaseOrder   PurchaseOrder @relation(fields: [purchaseOrderId], references: [id], onDelete: Cascade)
  materialId      String
  material        Material      @relation(fields: [materialId], references: [id])
  quoteItemId     String?
  quoteItem       QuoteItem?    @relation(fields: [quoteItemId], references: [id])
  quantity        Float
  unitPrice       Float         @default(0)
  totalPrice      Float         @default(0)
  receivedQty     Float         @default(0)
  deliveryDays    Int?
  notes           String?
  createdAt       DateTime      @default(now())
  updatedAt       DateTime      @updatedAt
  
  receivedInvoiceItems ReceivedInvoiceItem[]

  @@index([purchaseOrderId])
  @@index([materialId])
  @@map("purchase_order_items")
}

// =============================================================================
// AUDITORIA (Governança)
// =============================================================================

enum AuditAction {
  CREATE
  UPDATE
  DELETE
  VIEW
  LOGIN
  LOGOUT
  EXPORT
  IMPORT
}

model AuditLog {
  id            String      @id @default(uuid()) @db.Uuid
  
  // Quem fez a ação
  userId        String?     @db.Uuid
  user          User?       @relation(fields: [userId], references: [id])
  userEmail     String?     // Backup caso user seja deletado
  userName      String?     // Backup caso user seja deletado
  
  // Contexto da empresa
  companyId     String?     @db.Uuid
  companyName   String?     // Backup caso company seja deletada
  
  // O que foi feito
  action        AuditAction
  entityType    String      // Ex: "Material", "Supplier", "Inventory"
  entityId      String?     // ID do registro afetado
  entityCode    String?     // Código legível (ex: código do material)
  
  // Detalhes da mudança
  description   String?     // Descrição legível da ação
  oldValues     Json?       // Valores anteriores (para UPDATE/DELETE)
  newValues     Json?       // Novos valores (para CREATE/UPDATE)
  changedFields String[]    @default([])
  
  // Metadados técnicos
  ipAddress     String?
  userAgent     String?
  requestPath   String?     // Rota da API chamada
  requestMethod String?     // GET, POST, PUT, DELETE
  
  // Timestamp
  createdAt     DateTime    @default(now())
  
  @@index([userId])
  @@index([companyId])
  @@index([entityType, entityId])
  @@index([action])
  @@index([createdAt])
  @@map("audit_logs")
}

// =============================================================================
// MÓDULO CP14 - ENTRADA DE NFe (EVOLUÍDO)
// =============================================================================

enum InvoiceStatus {
  PENDING     // Aguardando conferência
  VALIDATED   // Validado, aguardando aprovação
  APPROVED    // Aprovado, entrada realizada
  REJECTED    // Rejeitado
  CANCELLED   // Cancelado
}

enum MatchStatus {
  PENDING     // Aguardando vinculação
  MATCHED     // Vinculado com sucesso
  DIVERGENT   // Vinculado com divergência
  NOT_FOUND   // Material não encontrado
}

model ReceivedInvoice {
  id              String        @id @default(uuid())
  accessKey       String        @unique @db.VarChar(44)
  invoiceNumber   Int
  series          Int           @default(1)
  issueDate       DateTime
  
  // Fornecedor
  supplierId      String?
  supplier        Supplier?     @relation(fields: [supplierId], references: [id])
  supplierCnpj    String        @db.VarChar(18)
  supplierName    String        @db.VarChar(255)
  
  // Valores
  totalProducts   Float         @default(0)
  totalInvoice    Float         @default(0)
  freightValue    Float         @default(0)
  discountValue   Float         @default(0)
  
  // Impostos
  icmsBase        Float         @default(0)
  icmsValue       Float         @default(0)
  ipiValue        Float         @default(0)
  pisValue        Float         @default(0)
  cofinsValue     Float         @default(0)
  
  // Status
  status          InvoiceStatus @default(PENDING)
  
  // Relacionamentos
  purchaseOrderId String?
  purchaseOrder   PurchaseOrder? @relation(fields: [purchaseOrderId], references: [id])
  items           ReceivedInvoiceItem[]
  
  // Auditoria
  receivedAt      DateTime?
  receivedBy      String?
  approvedAt      DateTime?
  approvedBy      String?
  rejectedAt      DateTime?
  rejectedBy      String?
  rejectionReason String?
  
  // Multi-tenant
  companyId       String?
  company         Company?      @relation(fields: [companyId], references: [id])
  
  // XML original
  xmlContent      String?       @db.Text
  
  createdAt       DateTime      @default(now())
  updatedAt       DateTime      @updatedAt
  
  // Títulos a pagar gerados
  accountsPayable AccountsPayable[]
  
  @@index([status])
  @@index([companyId])
  @@index([supplierId])
  @@index([issueDate])
  @@map("received_invoices")
}

model ReceivedInvoiceItem {
  id                    String        @id @default(uuid())
  invoiceId             String
  invoice               ReceivedInvoice @relation(fields: [invoiceId], references: [id], onDelete: Cascade)
  
  // Dados do XML
  itemNumber            Int
  productCode           String        @db.VarChar(60)
  productName           String        @db.VarChar(255)
  ncm                   String?       @db.VarChar(10)
  cfop                  Int
  quantity              Float
  unit                  String        @db.VarChar(10)
  unitPrice             Float
  totalPrice            Float
  
  // Impostos do item
  icmsRate              Float         @default(0)
  icmsValue             Float         @default(0)
  ipiRate               Float         @default(0)
  ipiValue              Float         @default(0)
  
  // Vinculação
  materialId            String?
  material              Material?     @relation(fields: [materialId], references: [id])
  purchaseOrderItemId   String?
  purchaseOrderItem     PurchaseOrderItem? @relation(fields: [purchaseOrderItemId], references: [id])
  
  // Conferência
  matchStatus           MatchStatus   @default(PENDING)
  divergenceType        String?       @db.VarChar(20)
  divergenceNote        String?
  
  // Recebimento
  receivedQty           Float         @default(0)
  
  createdAt             DateTime      @default(now())
  
  @@index([invoiceId])
  @@index([materialId])
  @@index([matchStatus])
  @@map("received_invoice_items")
}

// =============================================================================
// MÓDULO FN10 - CONTAS A PAGAR
// =============================================================================

model AccountsPayable {
  id              String         @id @default(uuid())
  code            Int            // número do título
  companyId       String?
  company         Company?       @relation(fields: [companyId], references: [id])
  
  // Fornecedor
  supplierId      String
  supplier        Supplier       @relation(fields: [supplierId], references: [id])
  
  // Documento de origem
  documentType    PayableType    @default(INVOICE)
  documentNumber  String?        // número da NF
  documentId      String?        // ID da NFe (ReceivedInvoice)
  invoiceId       String?
  invoice         ReceivedInvoice? @relation(fields: [invoiceId], references: [id])
  
  // Valores
  description     String
  dueDate         DateTime       // data de vencimento
  issueDate       DateTime       @default(now()) // data de emissão
  originalValue   Float          // valor original
  discountValue   Float          @default(0) // desconto
  interestValue   Float          @default(0) // juros
  fineValue       Float          @default(0) // multa
  paidValue       Float          @default(0) // valor pago
  netValue        Float          // valor líquido a pagar
  
  // Status
  status          PayableStatus  @default(PENDING)
  paidAt          DateTime?      // data do pagamento
  
  // Parcela
  installmentNumber Int          @default(1) // número da parcela
  totalInstallments Int          @default(1) // total de parcelas
  
  // Categorização
  categoryId      String?        // natureza financeira
  costCenterId    String?        // centro de custo
  
  // Observações
  notes           String?
  barcode         String?        // código de barras do boleto
  
  // Auditoria
  createdBy       String?
  createdAt       DateTime       @default(now())
  updatedAt       DateTime       @updatedAt
  
  // Pagamentos
  payments        PayablePayment[]
  
  @@unique([companyId, code])
  @@index([supplierId])
  @@index([companyId])
  @@index([status])
  @@index([dueDate])
  @@index([invoiceId])
  @@map("accounts_payable")
}

model PayablePayment {
  id              String         @id @default(uuid())
  payableId       String
  payable         AccountsPayable @relation(fields: [payableId], references: [id])
  
  paymentDate     DateTime       // data do pagamento
  value           Float          // valor pago
  discountValue   Float          @default(0) // desconto obtido
  interestValue   Float          @default(0) // juros pagos
  fineValue       Float          @default(0) // multa paga
  
  paymentMethod   String?        // forma de pagamento
  bankAccountId   String?        // conta bancária
  
  notes           String?
  
  createdBy       String?
  createdAt       DateTime       @default(now())
  
  @@index([payableId])
  @@index([paymentDate])
  @@map("payable_payments")
}
